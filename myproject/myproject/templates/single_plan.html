{% extends "base.html" %}
{% load staticfiles %}

{% block title %}{% endblock %}


{% block head %}

    <script src="{% static "js/three.min.js" %}"></script>
    <!-- todo: decide weather you need it in single_plan.js -->
    <script src="{% static "js/OrbitControls.js" %}"></script>

    <script src="{% static "js/diff_match_patch.js" %}"></script>  <!-- diff -->

    <script>

        var path_to_static = {% static "" %};
        var csrf_token = '{{ csrf_token }}';

        var creation_timer = {{ user.time_diff_creation}};
        var evaluation_timer = {{ user.time_diff_evaluation}};


        {% if user.is_authenticated %}
            var is_authenticated = true;
        {% else %}
            var is_authenticated = false;
        {% endif %}

        var plan_json = {{ plan_json | safe}};  // plan will be render in any occasion.
        var is_make = false;

    </script>

    <script src="{% static "js/helper_functions.js" %}"></script>
    {#    <script src="{% static "js/single_plan.js" %}"></script>#}

    <script src="{% static "js/model_manipulation.js" %}"></script>
    <script src="{% static "js/events.js" %}"></script>  // events will be assigned inside make.js, setup_events

    <script src="{% static "model/class/Axis.js" %}"></script>
    <script src="{% static "model/class/Ground.js" %}"></script>
    <script src="{% static "model/class/Cursor.js" %}"></script>
    <script src="{% static "model/class/Light.js" %}"></script>
    <script src="{% static "model/class/Cube.js" %}"></script>
    <script src="{% static "model/class/Wall.js" %}"></script>
    <script src="{% static "model/class/Floor.js" %}"></script>
    <script src="{% static "model/class/Plan.js" %}"></script>

    <script>
        $(document).ready(function () {
            initialize();
            // 'initialize' written in make.js
        });
    </script>


{% endblock %}

{% block header %}
    <!-- authentication process -->
    {% include "header_with_login.html" %}
{% endblock %}

{% block contents %}

    <div class="go_back" onclick="document.location.href='../../'">go back</div>

    <div id="timers">
        <div id="timers_creation"></div>
        <div id="timers_evaluation"></div>
    </div>

    <div id="model_info">
        {{ plan.id }}<br>
        {{ plan.name }}<br>
        {{ plan.creation_time }}<br>
        {{ plan.image_file }}<br>
        {{ plan.similarity }}<br>
        {{ plan.geometry }}<br>
        <span id="plan_total_points">{{ plan.get_total_points }}</span><br>
        {{ plan.architect.username }}<br>
        {% if plan.parent_plan %}
            {{ plan.parent_plan.name }}
        {% endif %}
    </div>

    <div id="model_action">
        {% if user.is_authenticated %}
            <div id="model_add_points" onclick="add_points({{ plan.id }},10.0)">add points</div>
        {% else %}
            you can add points by logging in.
        {% endif %}
        <div id="model_make_plan" onclick="make_plan({{ plan.id }})">make plan</div>
    </div>

{% endblock %}

{% block footer %}

{% endblock %}

{% block canvas %}
    <div id="webgl_canvas"></div>
{% endblock %}